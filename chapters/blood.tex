\chapter{Модель образования белого тромба}
\label{chapter:blood} \index{Модель}

\section{Модели распределения тромбоцитов в объёме}
\label{section:volume_distribution_models}

%При моделировании слипания тромбоцитов и механических свойств слипшейся массы разумно отказаться от феноменологического подхода
%и получить необходимые законы из вспомогательных теоретических результатов.
%В перспективе это может позволить уменьшить число параметров модели,
%сделать их более интерпретируемыми.

%В основе слипания тромбоцитов и роста вязкости тромба лежит связывание тромбоцитов
%сетью из развёрнутых молекул фактора фон Виллебранда, длина которых 

Распределение тромбоцитов в объёме напрямую влияет на формирование связей между ними,
что сказывается как на механических свойствах слипшейся массы, так и на скорости слипания.
Отсюда следует важность отдельного моделирования объёмного распределения тромбоцитов.

В данном разделе рассматривается вывод закона распределения из небольшого числа интуитивно понятных предположений.
Во-первых, предполагается, что при достижении предельной концентрации взаимное расположение тромбоцитов
близко к плотной упаковке трёхмерных шаров.
Во-вторых, считается, что при малых концентрациях тромбоциты распределены по объёму почти равномерно и случайно,
их взаимодействие между собой несущественно.
В-третьих, предполагается существование для средних значений концентрации переходного режима,
в котором распределение тромбоцитов всё еще достаточно случайное,
но взаимодействием между ними пренебрегать уже нельзя в силу значительности занимаемого ими объёма.


\subsection{Случай высокой концентрации}
\label{subsection:volume_distribution_models:high_concentration}

Высокая концентрация соответствует сформировавшемуся тромбу.
Тромбоциты в таком тромбе прилегают друг другу плотно.
В приближении сферически симметричных тромбоцитов
можно задействовать известный результат для плотной упаковки трёхмерных шаров:

\begin{theorem}[Гаусс, Кеплер, Хейлз~\cite{hales2002overview_kepler}]
    \label{theorem:high_concentration:packed_balls}
    В пространстве $ \reals^3 $ рассмотрим последовательность ограниченных измеримых множеств $ S_n $ таких,
    что $ n $-ое множество содержит шар радиуса хотя бы $ n $.
    Пусть $ \setfamily_n $~--- семейство подмножеств $ S_n $,
    являющихся дизъюнктным объединением единичных шаров.
    Пусть $ \varphi \colon \bigcup_{n \in \naturals} \setfamily_n \to \naturals_0 $
    отображает дизъюнктное объединение шаров в число шаров в этом объединении.
    Тогда
    \[
        \lim_{n \to \infty} \max_{R \in \setfamily_n} \frac{\varphi(R)}{\mu(S_n)} = \frac{\pi}{3 \sqrt{2}}
    \]
\end{theorem}

Таким образом, максимально возможная концентрация частиц радиуса $ R $ равна
\[
    n_\textnormal{max} = \frac{\pi}{3 \sqrt{2}} \cdot \frac{1}{\frac{4}{3} \pi R^3}
    = \frac{1}{4 \sqrt{2} R^3}
    = \frac{\sqrt{2}}{(2R)^3}
\]
Размер тромбоцитов в человеческой крови составляет примерно
$ 3 - 4 $ мкм~\cite{rumbaut2010platelets-vessel_interactions}.
Приняв этот размер за диаметр, получаем значение предельной концентрации:
от $ 2 \cdot 10^{16} \; \textnormal{м}^{-3} $ до $ 6 \cdot 10^{16} \; \textnormal{м}^{-3} $,
или примерно $ 40 \cdot 10^6 \; \textnormal{мкл}^{-1} $.
При нормальных условиях концентрация тромбоцитов в крови человека примерно равна
$ 0.3 \cdot 10^6 \; \textnormal{мкл}^{-1} $~\cite{zhang2022COPD_risk},
что более чем в $ 100 $ раз меньше предельной концентрации
(или, иначе говоря, среднее расстояние между тромбоцитами примерно в $ \sqrt[3]{100} \approx 5 $ раз больше их радиуса).

Таким образом, можно вполне справедливо полагать,
что на ранних этапах образования тромба концентрация тромбоцитов достаточно мала.


\subsection{Случай низкой концентрации}
\label{subsection:volume_distribution_models:low_concentration}

Рассмотрим сосуд объёма $ V_0 $,
наполненный жидкостью с равномерно распределённой примесью концентрации $ n = N / V_0 $.
Число частиц в части сосуда объёма $ V $ распределено биномиально с параметром $ p = V n / N = V / V_0 $:
\[
    \proba\{ \textnormal{\# частиц} = k \} = \binom{N}{k} \left(\frac{V}{V_0}\right)^k \left(1 - \frac{V}{V_0} \right)^{N-k}
\]
При устремлении $ V_0 / V \to +\infty $ получаем известный результат~---
распределение Пуассона для числа частиц в малом объёме:
%
\begin{multline*}
    \proba\{ \textnormal{\# частиц} = k \} \sim \frac{N^k}{k!} \left( \frac{V}{V_0} \right)^k \left( 1 - \frac{V}{V_0} \right)^N = \\ =
    \frac{(V_0 n)^k}{k!} \left( \frac{V}{V_0} \right)^k \left( 1 - \frac{V}{V_0} \right)^{V_0 n} \sim \frac{(V n)^k}{k!} e^{- V n} 
\end{multline*}
%
Заметим, что вероятность обнаружить в объёме $ V $ не менее $ k $ частиц равна
%
\begin{multline}
    \label{eq:low_concentration:volume_distribution}
    \proba\{ \textnormal{\# частиц} \geqslant k \} =
    1 - \proba\{ \textnormal{\# частиц} < k \} =
    1 - \sum_{m = 0}^{k-1} \proba\{ \textnormal{\# частиц} = m \} = \\ =
    1 - e^{- V n} \sum_{m = 0}^{k-1} \frac{(V n)^m}{m!}
\end{multline}
%
Полученное выражение является функцией распределения для
\emph{гамма"=распределения} с параметрами $ k $, $ 1/n $.

Нас интересует вероятностное распределение расстояния от выбранной частицы до $ k $-ого ближайшего соседа
(обозначим это расстояние $ r_k $).
То есть, что эквивалентно, вероятностное распределение объёма шара,
в котором есть хотя бы $ k $ частиц (помимо центра).

Обозначим $ V(r) $ и $ S(r) $~--- объём шара и площадь сферы радиуса $ r $ соответственно
(в трёхмерном случае~--- $ \frac{4}{3} \pi r^3 $ и $ 4 \pi r^2 $ соответственно).
%
\begin{equation}
    \label{eq:low_concentration:kNN-volume_equvalence}
    \proba\{r_k < x\} = \proba \left\{\textnormal{в $ V = V(x) $ находится $ \geqslant k $ частиц} \right\}
\end{equation}
%
Комбинируя~\eqref{eq:low_concentration:volume_distribution} и \eqref{eq:low_concentration:kNN-volume_equvalence},
получаем функцию распределения для $ r_k $:
%
\begin{equation}
    \label{eq:low_concentration:kNN_distance_CDF}
    F_{r_k}(x) = 1 - e^{- V(x) n} \sum_{m = 0}^{k-1} \frac{(V(x) n)^m}{m!}
\end{equation}
%
Дифференцируя по $ x $ (с учётом соотношения $ \partial V(x) / \partial x = S(x) $),
получаем плотность распределения:
%
\begin{multline}
    \label{eq:low_concentration:kNN_distance_PDF}
    \rho_{r_k}(x) = e^{-V(x) n} \cdot \left[ S(x) n \sum_{m = 0}^{k-1} \frac{(V(x) n)^m}{m!} -
    \sum_{m = 1}^{k-1} \frac{S(x) n (V(x) n)^{m-1}}{(m-1)!} \right] = \\ =
    S(x) n \cdot e^{-V(x) n} \frac{(V(x) n)^{k-1}}{(k-1)!}
\end{multline}
%
Характерный вид $ F_{r_k}(x) $ и $ \rho_{r_k}(x) $ представлен
на рисунке~\ref{fig:low_concentration:kNN_distance_distribution_plots}.

\begin{figure}[ht!]
    \centering
    \begin{subfigure}[t]{0.5\textwidth}
        \centering
        \captionsetup{aboveskip=-\baselineskip}
        \begin{gnuplot}[terminal=tikz, terminaloptions={color size 8.0cm,5.0cm fontscale 0.8}]
            load "./gnuplot/common.gp"
            load "./gnuplot/kNN_distribution.gp"

            set yrange [0:1]

            f_1(x)  = F_r(x,3,1)
            f_4(x)  = F_r(x,3,4)
            f_10(x) = F_r(x,3,10)

            plot [0:3] f_1(x) lw 2 t "$ F_{r_1}(x) $", \
                       f_4(x) lw 2 t "$ F_{r_4}(x) $", \
                       f_10(x) lw 2 t "$ F_{r_{10}}(x) $"
        \end{gnuplot}
        \caption{Функции распределения $ F_{r_k}(x) $.}
    \end{subfigure}%
    \begin{subfigure}[t]{0.5\textwidth}
        \centering
        \captionsetup{aboveskip=-\baselineskip}
        \begin{gnuplot}[terminal=tikz, terminaloptions={color size 8.0cm,5.0cm fontscale 0.8}]
            load "./gnuplot/common.gp"
            load "./gnuplot/kNN_distribution.gp"

            f_1(x)  = rho_r(x,3,1)
            f_4(x)  = rho_r(x,3,4)
            f_10(x) = rho_r(x,3,10)

            plot [0:3] f_1(x) lw 2 t "$ \\rho_{r_1}(x) $", \
                        f_4(x) lw 2 t "$ \\rho_{r_4}(x) $", \
                        f_10(x) lw 2 t "$ \\rho_{r_{10}}(x) $"
        \end{gnuplot}
        \caption{Функций плотности вероятности $ \rho_{r_k}(x) $.}
    \end{subfigure}
    \caption{Графики распределения случайной величины $ r_k $ для $ k \in \{1, 4, 10 \} $.}
    \label{fig:low_concentration:kNN_distance_distribution_plots}
\end{figure}


% В общем случае объём и площадь поверхности $ d $-мерного шара равны, соответственно,
% \begin{equation}
%     \label{eq:volume_distribution_models:d-dim_ball_volume_and_surface}
%     V_d(r) = \frac{\pi^{d/2}}{\Gamma(d/2 + 1)} \cdot r^d \qquad S_d(r) = 2 \pi V_{d-1}(r)
% \end{equation}
% Отсюда имеем
% \[
%     r = \frac{1}{\sqrt{\pi}} \left[ \Gamma(d/2+1) V_d(r) \right]^{1/d},
% \]
Найдём моменты случайной величины $ r_k $.
Вспомним, что объём $ d $-мерного шара радиуса $ r $ пропорционален $ r^d $:
\[
    V_d(r) = V_d(1) \cdot r^d \quad \Longrightarrow \quad r = \sqrt[d]{V_d(r) / V_d(1)},
\]
Тогда
%
\begin{align}
    \label{eq:low_concentration:kNN_distance_expectation}
    \expect r_k^m &= \int\limits_0^{+\infty} x^m \rho_{r_k}(x) \, dx =
    \int\limits_0^{+\infty} x^m e^{-V(x) n} \frac{(V(x) n)^{k-1}}{(k-1)!} \, S(x) n \, dx = \\
    &= \int\limits_0^{+\infty} x^m(V) \cdot e^{-V n} \frac{(V n)^{k-1}}{(k-1)!} \, d(V n) = \\
    &= V(1)^{-m/d} \int\limits_0^{+\infty} V^{m/d} \cdot e^{-V n} \frac{(V n)^{k-1}}{(k-1)!} \, d(V n) = \\
    &= \frac{(V(1) n)^{-m/d}}{(k-1)!} \int\limits_0^{+\infty} z^{m/d + k - 1} e^{-z} dz
    = \frac{\Gamma(m/d + k)}{\Gamma(k)} (V(1) n)^{-m/d}
\end{align}
В частности, в трёхмерном случае среднее расстояние до ближайшего соседа примерно равно $ 0.83 \cdot n^{-1/3} $.

% \begin{figure}
%     \centering
%     \begin{subfigure}[t]{0.5\textwidth}
%         \centering
%         \begin{gnuplot}[terminal=tikz, terminaloptions={color size 8.5cm,5.0cm}]
%             load "./gnuplot/common.gp"
%             load "./gnuplot/kNN_distribution.gp"
% 
%             set yrange [0:1]
% 
%             f_1(x)  = F_r_normalized(x,3,1)
%             f_4(x)  = F_r_normalized(x,3,4)
%             f_10(x) = F_r_normalized(x,3,10)
% 
%             plot [-3:3] f_1(x) lw 2 t "$ F_{r_1}(x) $", \
%                         f_4(x) lw 2 t "$ F_{r_4}(x) $", \
%                         f_10(x) lw 2 t "$ F_{r_{10}}(x) $"
%         \end{gnuplot}
%         \caption{Характерный вид функций распределения $ F_{r_k}(x) $.}
%     \end{subfigure}%
%     \begin{subfigure}[t]{0.5\textwidth}
%         \centering
%         \begin{gnuplot}[terminal=tikz, terminaloptions={color size 8.5cm,5.0cm}]
%             load "./gnuplot/common.gp"
%             load "./gnuplot/kNN_distribution.gp"
% 
%             f_1(x)  = rho_r_normalized(x,3,1)
%             f_4(x)  = rho_r_normalized(x,3,4)
%             f_10(x) = rho_r_normalized(x,3,10)
% 
%             plot [-3:3] f_1(x) lw 2 t "$ \\rho_{r_1}(x) $", \
%                         f_4(x) lw 2 t "$ \\rho_{r_4}(x) $", \
%                         f_10(x) lw 2 t "$ \\rho_{r_{10}}(x) $"
%         \end{gnuplot}
%         \caption{Характерный вид плотности распределения $ \rho_{r_k}(x) $.}
%     \end{subfigure}
% \end{figure}


\section{Модели образования белого тромба}
\label{section:blood:white_clot_model}

В данном разделе будет предложена модель образования белого тромба,
дополняющие результаты работ~\cite{bouchnita2020mathematical, vassilevski2020parallel}.
Основу модели будут составлять две компоненты: свободные, липкие и закрепившиеся тромбоциты.
Первые два компартмента будут моделироваться пассивной примесью,
третий будет образовывать неподвижную пористую среду.
Реакционная часть модели позволит описать переход тромбоцитов из одного компартмента в другой
под действием слипания и разъединения потоком.
Модели вязкости и проницаемости слипшейся массы должны позволить воспроизвести наблюдаемые процессы закрепления тромба
и блокировки потока крови.

Программная имплементация основана на конечно-объемном коде
уравнения переноса-диффузии-реакции из работы~\cite{vassilevski2020parallel},
позволяющем модифицировать реакционную часть,
отключать перенос определённых примесей,
а также динамически менять вязкость и проницаемость среды.
Поэтому в настоящем разделе мы сфокусируемся только на существенных модификациях,
вносимых в используемую модель.
Конкретно, будут описаны новые реакционные члены, а также модель вязкости и проницаемости.

\subsection{Реакционная часть}
\label{subsection:white_clot_model:reactions}

Традиционно процесс образования белого тромба описывается
многокомпонентной моделью~\cite{sorensen1999platelets_deposition_model, goodman2005thrombosis_model, taylor2016thrombosis_model, wu2017deposition_model}.
Однако экспериментальные данные позволяют предположить,
что воспроизведение отдельно механизма слипания тромбоцитов может потребовать добавления
лишь небольшого числа новых компонент в существующую модель фибринового тромба.

Результаты лабораторных опытов говорят о том,
что в областях повышенных сдвиговых напряжений происходят качественные изменения тромбоцитов,
заставляющие их налипать на стенку ниже по течению,
где сдвиговое напряжение возвращается к нормальному значению~\cite{rahman2019platelet_adhesion}.
Также известно, что сдвиговое напряжение влияет и на местную агрегацию тромбоцитов:
при его повышении фибриновые и фибриногеновые связи наблюдаются реже,
а связи посредством фактора фон Виллебранда~--- чаще~\cite{savage1996platelet_adhesion}.
Такое поведение связано с механическими свойствами фактора фон Виллебранда:
при малых скоростях сдвига фактор свёрнут в глобулу
и не может сцеплять тромбоциты между собой и со стенкой,
однако высокое сдвиговое напряжение позволяют глобулам развернуться,
что приводит к агрегации тромбоцитов~\cite{lippok2016vWF_unfolding, zhussupbekov2021vWF_unfolding}.

Можно выдвинуть предположение,
что в областях с повышенным сдвиговым напряжением тромбоциты образуют липкие агрегаты,
скреплённые частично или полностью развёрнутым фактором фон Виллебранда.
Агрегаты могут далее оседать как в месте образования, так и ниже по течению.
Такая модель требует введения всего двух компонент:
концентрации липких и слипшихся тромбоцитов.
Требуется также учесть разрушение связей между тромбоцитами из-за механического воздействия
или других факторов.
Итоговые уравнения имеют вид
%
\begin{equation}
    \label{eq:reactions:general_reactions_equations}
    \begin{dcases}
        \frac{\partial \phi_f}{\partial t} &= -k_{f \to a} \cdot \phi_f + k_{\textnormal{da}} \cdot \phi_a \\
        \frac{\partial \phi_a}{\partial t} &=  k_{f \to a} \cdot \phi_f - k_{a \to d} \cdot \phi_a + k_{\textnormal{da}} \cdot (\phi_d - \phi_a) \\
        \frac{\partial \phi_d}{\partial t} &=  k_{a \to d} \cdot \phi_a - k_{\textnormal{da}} \cdot \phi_d \\
    \end{dcases}
\end{equation}
%
где $ \phi_f $, $ \phi_a $ и $ \phi_d $~--- концентрации свободных, липких и слипшихся тромбоцитов соответственно,
$ k_\textnormal{da} $~--- скорость дизагрегации тромбоцитов из-за внешнего воздействия,
а $ k_{f \to a} $ и $ k_{a \to d} $ отвечают за скорость агрегации и слипания тромбоцитов.
Концентрации $ \phi_f $ и $ \phi_a $ участвуют в переносе и диффузии в качестве пассивной примеси,
$ \phi_d $ же считается концентрацией строго неподвижной примеси.

Будем рассматривать случай высоких сдвиговых напряжений,
когда большая часть связей между тромбоцитами опосредована фактором фон Виллебранда.
В работе~\cite{savage1996platelet_adhesion} представлены данные,
описывающие динамику налипших на подложку с фактором фон Виллебранда тромбоцитов
с течением времени и при разных сдвиговых напряжениях.
Из них можно сделать вывод, что $ k_\text{da} $ почти не зависит от сдвигового напряжения
(что не так для фибрина и фибриногена) и примерно равен $ 3.3 \cdot 10^{-2} \; \text{с}^{-1} $.

Из той же работы также можно получить зависимость $ k_{f \to a} $ и $ k_{a \to d} $ от сдвигового напряжения,
которая должна быть пропорциональна предельному числу налипших на подложку тромбоцитов
%(рисунок 2 в~\cite{savage1996platelet_adhesion} и рисунок~\ref{fig:reactions:vWF_platelets_count}).
(рисунок~\ref{fig:reactions:vWF_platelets_count}).


\begin{figure}[ht!]
    \centering
    \small
    \begin{gnuplot}[terminal=tikz, terminaloptions={color size 16.0cm,8.0cm fontscale 0.8}]
        load './gnuplot/common.gp'

        set datafile separator ' '

        set style increment default
        set style data lines
        set xlabel  "$ \\dot \\gamma $"
        set xrange  [ 0 : 1600 ] noreverse writeback
        set ylabel  "$ N_\\textnormal{platelets} $" offset -1 #rotate by 0
        set yrange  [ 0 : 1000 ] noreverse writeback

        # Модель
        f(x) = 805.7 * (1.0 - 0.759 * exp(-2.845e-3 * x))

        set xtics 200
        #set xzeroaxis lw 2

        plot "./data/platelets/Savage_data.csv" using 1:3 with points ps 3 t "экспериментальные данные \\cite{savage1996platelet_adhesion}", \
             f(x) with lines lw 3 t "модель \\eqref{eq:reactions:vWF_shear_model}"
    \end{gnuplot}
    \caption{Зависимость числа налипших тромбоцитов от сдвигового напряжения в потоке у стенки~\cite{savage1996platelet_adhesion}.}
    \label{fig:reactions:vWF_platelets_count}
\end{figure}

Решая задачу наименьших квадратов с экспоненциальной моделью, получаем
%
\begin{equation}
    \label{eq:reactions:vWF_shear_model}
    k_{f \to a}, \; k_{a \to d} \sim 1 - a \, e^{-b \, \dot{\gamma}},
    \qquad
    a = 0.76, \;
    b = 2.85 \cdot 10^{-3} \; \textnormal{с},
\end{equation}
%
где $ \dot{\gamma} $~--- скорость сдвига.

В работе~\cite{wu2017deposition_model} предлагается считать процесс формирования тромба послойным,
то есть переход $ \phi_a \to \phi_d $ возможен только вблизи поверхности сосуда или уже образовавшегося тромба.
Математически данная идея формализуется посредством свёртки некоторого ядра $ K(\vec{r}) $,
ширина которого отвечает за характерное расстояние слипания тромбоцитов,
с функцией $ \alpha_c \cdot \phi_d(\vec{r}) + \alpha_b \cdot \indicator_{\partial \Omega_{\textnormal{adh}}}(\vec{r}) $,
где $ \partial \Omega_\textnormal{adh} $ обозначает границу области, на которую могут крепиться тромбоциты,
а коэффициенты $ \alpha $ регулируют скорость налипания.

На практике расстояния, на которых формируются связи между тромбоцитами,
гораздо меньше характерных размеров ячеек расчётной сетки,
а потому результат свёртки будет равен $ \alpha_c \cdot S_d + \alpha_b \cdot S_b $,
где $ S_b $~--- суммарная площадь контакта ячейки с той частью границы, на которую могут крепиться тромбоциты,
а $ S_c $~--- суммарная площадь контакта с соседними ячейками, в которых тромб уже сформирован.
В работе~\cite{wu2017deposition_model} предлагается следующая формула для $ S_c $:
\[
    S_c(\mathrm{c}) = \sum_{\mathrm{f} \in \textnormal{faces}(\mathrm{c})} |\mathrm{f}| \cdot
    (\phi_d(\mathrm{f}) / \phi_{\max}) \cdot \indicator_{[\phi_\textnormal{clot}; +\infty)}(\phi_d(\mathrm{f})),
\]
где $ \mathrm{c} $~--- рассматриваемая ячейка,
%$ |\mathrm{c}| $~--- объём ячейки $ \mathrm{c} $,
$ \textnormal{faces}(\mathrm{c}) $~--- грани ячейки $ \mathrm{c} $,
$ |\mathrm{f}| $~--- площадь грани $ \mathrm{f} $,
$ \phi_d(\mathrm{f}) $~--- концентрация $ \phi_d $
в ячейке через грань $ \mathrm{f} $ от $ \mathrm{c} $,
$ \phi_{\max} $~--- максимально допустимая концентрация тромбоцитов
(см.~\ref{subsection:volume_distribution_models:high_concentration}),
а $ \phi_{\textnormal{clot}} $~--- минимальная концентрация тромбоцитов в белом тромбе
(определяется экспериментально).


\subsection{Модель вязкости}
\label{subsection:white_clot_model:viscocity}

В работе~\cite{jamiolkowski2016visualization} было продемонстрировано,
что белый тромб ведёт себя как вязкопластичная среда,
вязкость которой растёт по мере роста концентрации за счёт образования новых связей между тромбоцитами.
Пренебрегая пластичным аспектом,
построим модель вязкости тромба из предположения о её пропорциональности числу связей между липкими ($ \phi_a $) тромбоцитами;
связи между уже слипшимися и закрепившимися тромбоцитами не рассматриваются, так как последние формируют неподвижную массу,
не участвующую в переносе и диффузии.

Микрофотографии, приведённые в работе~\cite{schneider2007vWF_unfolding},
говорят о том, что агрегация тромбоцитов посредством
фактора фон Виллебранда может наблюдаться на расстоянии до $ 10 - 15 \; \text{мкм} $;
обозначим данное характерное расстояние за $ L_\textnormal{vWF} $ .
При этом можно предполагать, что сравнительно устойчивые агрегаты формируются только тогда,
когда каждый тромбоцит сцеплен с тремя или более другими тромбоцитами.
Тогда можно рассмотреть следующую модель вязкости:
%
\begin{equation}
    \label{eq:viscocity:viscocity_model}
    \nu = \nu_0 \cdot (1 + \beta \cdot F_{r_k}(L_\textnormal{vWF})),
\end{equation}
%
где $ \nu_0 $~--- вязкость крови без агрегаций из тромбоцитов,
$ F_{r_k} $ определена в уравнении~\eqref{eq:low_concentration:kNN_distance_CDF},
$ \beta $~--- параметр влияния степени агрегации тромбоцитов на вязкость,
$ k \approx 4 $, $ L_\textnormal{vWF} \approx 10 \; \textnormal{мкм} $.
В действительности $ \beta $ также зависит от скорости сдвига
(нелинейная вязкость), однако данных для восстановления зависимости не хватает;
в качестве начального приближения можно взять $ \beta \approx 5 - 20 $~\cite{ranucci2014clot_viscocity}.


\subsection{Модель проницаемости}
\label{subsection:white_clot_model:permeability}

Вопрос о проницаемости и пористой структуре тромба подробно исследован в работе~\cite{wufsus2013clot_permeability}.
Было показано, что модель Кожены-Кармана~\cite{warrenl1976chemical_engineering}
достаточно хорошо описывает зависимость проницаемости тромба от концентрации тромбоцитов:
%
\begin{equation}
    \label{eq:permeability:Kozeny_Carmen}
    k_p = \frac{\Psi_p^2 \cdot d_p^2 \cdot (1 - \phi_d)^3}{150 \cdot \phi_d^3},
\end{equation}
%
где $ \Psi_p $~--- сферичность тромбоцитов ($ \approx 0.7 $~\cite{wufsus2013clot_permeability}),
$ d_p $~--- диаметр тромбоцитов.
